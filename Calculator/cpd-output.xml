<?xml version="1.0" encoding="UTF-8"?>
<pmd-cpd>
   <duplication lines="49" tokens="327">
      <file line="167"
            path="/Users/anton/Desktop/Swift/HomeTasks/Calculator/Calculator/CalculatorViewController.swift"/>
      <file line="162"
            path="/Users/anton/Desktop/Swift/HomeTasks/Calculator/Calculator/Controllers/CalculatorViewController.swift"/>
      <codefragment><![CDATA[        guard let description = descriptionHandler.getDescription else {
            assertionFailure("There is no description")
            return
        }

        if processor.resultIsPending {
            sequanceOfOperationsLabel.text = description + "..."
        } else if processor.isListEmpty(.undo) {
            sequanceOfOperationsLabel.text = description
        } else {
            sequanceOfOperationsLabel.text = description + "="
        }
    }

    private func radToDeg(currentState: String) {
        if currentState == "Rad" {
            degreeToRadianButton.setTitle("Deg", for: .normal)
        } else {
            degreeToRadianButton.setTitle("Rad", for: .normal)
        }
    }

    private func changeFunctionButtons() {
        exyxButton.setTitle("y^x", for: .normal)
        from10x2xButton.setTitle("2^x", for: .normal)
        fromLntoLogy.setTitle("logy", for: .normal)
        fromLog10toLog2.setTitle("log2", for: .normal)
        sinMinus1.setTitle("sin-1", for: .normal)
        sinhMinus1.setTitle("sinh-1", for: .normal)
        cosMinus1.setTitle("cos-1", for: .normal)
        coshMinus1.setTitle("cosh-1", for: .normal)
        tanMinus1.setTitle("tan-1", for: .normal)
        tanhMinus1.setTitle("tanh-1", for: .normal)
    }

    private func changeFunctionButtonsBack() {
        exyxButton.setTitle("e^x", for: .normal)
        from10x2xButton.setTitle("10^x", for: .normal)
        fromLntoLogy.setTitle("ln", for: .normal)
        fromLog10toLog2.setTitle("log10", for: .normal)
        sinMinus1.setTitle("sin", for: .normal)
        sinhMinus1.setTitle("sinh", for: .normal)
        cosMinus1.setTitle("cos", for: .normal)
        coshMinus1.setTitle("cosh", for: .normal)
        tanMinus1.setTitle("tan", for: .normal)
        tanhMinus1.setTitle("tanh", for: .normal)
    }

    private func configureFormatter() {]]></codefragment>
   </duplication>
   <duplication lines="37" tokens="215">
      <file line="115"
            path="/Users/anton/Desktop/Swift/HomeTasks/Calculator/Calculator/CalculatorViewController.swift"/>
      <file line="112"
            path="/Users/anton/Desktop/Swift/HomeTasks/Calculator/Calculator/Controllers/CalculatorViewController.swift"/>
      <codefragment><![CDATA[        userIsInTheMiddleOfTyping = true

        let result = Double(drand48())
        displayLabel.text = String(result)
    }

    @IBAction func showAdditionalOperations(_ sender: UIButton) {
        if !sender.isSelected {
            sender.isSelected = true
            sender.titleLabel?.textColor = UIColor.black
            sender.backgroundColor = #colorLiteral(red: 0.4980392157, green: 0.4980392157, blue: 0.5019607843, alpha: 1)

            changeFunctionButtons()
        } else if sender.isSelected {
            sender.isSelected = false
            sender.titleLabel?.textColor = UIColor.white
            sender.backgroundColor = #colorLiteral(red: 0.1294117647, green: 0.1294117647, blue: 0.1333333333, alpha: 1)

            changeFunctionButtonsBack()
        }
    }

    // MARK: - Private

    private func formatToDergeeOrRad(number: Double, _ operation: String) -> Double {
        var newNumber = number
        if trigOperations.contains(operation) && degreeToRadianButton.currentTitle == "Deg" {
            newNumber = number.degreesToRadians
            return newNumber
        }
        return number
    }

    private func handleUndoRedo(operation: UndoRedo) {
        switch operation {
        case .undo where !processor.isListEmpty(.undo) :
            processor.appendTo(.redo, symbol: processor.returnLastFrom(.undo))]]></codefragment>
   </duplication>
   <duplication lines="33" tokens="214">
      <file line="1"
            path="/Users/anton/Desktop/Swift/HomeTasks/Calculator/Calculator/CalculatorViewController.swift"/>
      <file line="1"
            path="/Users/anton/Desktop/Swift/HomeTasks/Calculator/Calculator/Controllers/CalculatorViewController.swift"/>
      <codefragment><![CDATA[import UIKit

final class CalculatorViewController: UIViewController {
    // MARK: - Outlets

    @IBOutlet weak private var sequanceOfOperationsLabel: UILabel!
    @IBOutlet weak private var displayLabel: UILabel!
    @IBOutlet weak private var memoryLabel: UILabel!

    @IBOutlet weak private var exyxButton: RoundedButton!
    @IBOutlet weak private var from10x2xButton: RoundedButton!
    @IBOutlet weak private var fromLntoLogy: RoundedButton!
    @IBOutlet weak private var fromLog10toLog2: RoundedButton!
    @IBOutlet weak private var sinMinus1: RoundedButton!
    @IBOutlet weak private var sinhMinus1: RoundedButton!
    @IBOutlet weak private var cosMinus1: RoundedButton!
    @IBOutlet weak private var coshMinus1: RoundedButton!
    @IBOutlet weak private var tanMinus1: RoundedButton!
    @IBOutlet weak private var tanhMinus1: RoundedButton!
    @IBOutlet weak private var cleanButton: RoundedButton!
    @IBOutlet weak private var degreeToRadianButton: RoundedButton!
    @IBOutlet weak private var divideButton: RoundedButton!
    @IBOutlet weak private var multiplyButton: RoundedButton!
    @IBOutlet weak private var minusButton: RoundedButton!
    @IBOutlet weak private var plusButton: RoundedButton!

    // MARK: - Private properties

    private let trigOperations: Set = ["sin-1", "sinh-1", "cos-1",
                                       "cosh-1", "tan-1", "tanh-1",
                                       "sinh", "sin", "cos",
                                       "cosh", "tan", "tanh"]
    private let formatter = NumberFormatter()]]></codefragment>
   </duplication>
   <duplication lines="25" tokens="129">
      <file line="36"
            path="/Users/anton/Desktop/Swift/HomeTasks/Calculator/Calculator/CalculatorViewController.swift"/>
      <file line="36"
            path="/Users/anton/Desktop/Swift/HomeTasks/Calculator/Calculator/Controllers/CalculatorViewController.swift"/>
      <codefragment><![CDATA[    private var userIsInTheMiddleOfTyping = false
    private var numberOfCharacterGreaterThan16: Bool {
        return (displayLabel.text?.count)! >= 16
    }
    private var displayValue: Double {
        get {
            let displayText = displayLabel.text ?? "0"

            let displayTextWithoutCommas = displayText.replacingOccurrences(of: ",", with: ".")
            let displayTextWithoutCommasAndSpaces = displayTextWithoutCommas.replacingOccurrences(of: " ", with: "")

            return Double(displayTextWithoutCommasAndSpaces) ?? 0
        }
        set {
            if let result = formatter.string(from: newValue as NSNumber) {
                let displayTextWithCommas = result.replacingOccurrences(of: ".", with: ",")
                displayLabel.text = displayTextWithCommas
            }
        }
    }

    // MARK: - Lifecycle

    override func viewDidLoad() {
        super.viewDidLoad()]]></codefragment>
   </duplication>
   <duplication lines="15" tokens="64">
      <file line="70"
            path="/Users/anton/Desktop/Swift/HomeTasks/Calculator/Calculator/CalculatorViewController.swift"/>
      <file line="68"
            path="/Users/anton/Desktop/Swift/HomeTasks/Calculator/Calculator/Controllers/CalculatorViewController.swift"/>
      <codefragment><![CDATA[    @IBAction func nonOperationButtonTapped(_ sender: UIButton) {
        guard let character = sender.currentTitle else {
            assertionFailure("Failed to get the title")
            return
        }

        switch character {
        case ",": decimalPointTapped()
        case "C", "AC": cleanDisplay()
        case "Rad", "Deg": radToDeg(currentState: character)
        default: performDigitTapping(digit: character)
        }
    }

    @IBAction func performOperation(_ sender: UIButton) {]]></codefragment>
   </duplication>
</pmd-cpd>
